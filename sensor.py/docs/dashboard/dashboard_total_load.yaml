type: custom:apexcharts-card
header:
  title: Total load
  show: true
graph_span: 24h
span:
  start: day
now:
  show: false
apex_config:
  chart:
    type: area
    height: 300
    toolbar:
      show: true
      tools:
        download: true
        selection: true
        zoom: true
        zoomin: true
        zoomout: true
        pan: true
        reset: true
  xaxis:
    type: datetime
    labels:
      format: HH:mm
      rotate: -45
  yaxis:
    - min: 0
      title:
        text: Power (W)
        style:
          fontSize: '12px'
  legend:
    position: top
    horizontalAlign: right
    fontSize: '12px'
  tooltip:
    shared: true
    intersect: false
card_mod:
  style: |
    ha-card {
      background: var(--card-background-color);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
series:
  - entity: sensor.device_YOUR_DEVICE_ID_total_load_today
    name: Consumption (W)
    type: area
    color: "#4169E1"
    stroke_width: 2
    fill_opacity: 0.3
    data_generator: |
      return (function() {
        const series = entity.attributes.series_5min_w || [];
        const now = new Date();
        const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
        
        // Map tất cả 288 điểm (24 giờ * 12 điểm/giờ)
        return series.map(function(value, index) {
          const hours = Math.floor(index / 12);
          const minutes = (index % 12) * 5;
          const timestamp = new Date(startOfDay);
          timestamp.setHours(hours, minutes, 0, 0);
          return [timestamp.getTime(), parseFloat(value) || 0];
        });
      })();
